# 도커 파일

## 도커파일이란?
 - 컨테이너에 설치해야하는 패키지, 소스코드, 명령어, 환경변수설정 등을 기록한 하나의 파일이다. 
 - 도커파일을 빌드하면 자동으로 도커 이미지가 생성된다. 이를 이용해 애플리케이션 빌드 및 배포를 자동화할 수 있게된다.
 - 도커파일로 이미지를 생성할 때의 장점은 다음과 같다.
   - 코드 형태로 되어 버전 관리가 용이하다.
   - 이미지의 기능을 파악하기 쉽다.
   - CMD, ENTRYPOINT 등 도커파일만의 유용한 기능을 제공한다.
   
## 도커파일의 지시어

### FROM
 - 생성할 이미지의 '베이스가 될 이미지'를 뜻한다. 도커허브에서 어떠한 이미지를 가져와 작업할지를 선언한다.
 - 반드시 맨 처음에, 한 번 이상 입력해야 된다. 
 - `<이미지명>:<태그>`형식으로 작성
### LABEL
 -  이미지에 메타데이터 추가.
   - 메타데이터 : 이미지를 효율적으로 사용하게 해주는 설정값들. 이미지에 대한 설명을 제공하거나 이미지에 필요한 리소스, 애플리케이션 등을 지정할 수 있다.
 - 추후에 원하는 조건의 컨테이너, 이미지 등을 쉽게 찾을 수 있도록 도와주기 때문에 기억해두는게 좋다.
### RUN
 - 이미지를 만들기 위해 컨테이너 내부에서 실행하는 명령어.
 - 주로 패키지를 설치하는 명령에 사용한다.
 - 해당 내용이 적을수록 container label이 적게 생성되어 이미지를 컴팩트하게 생성할 수 있다.
### ADD 
 - 이미지 생성 시 특정 파일을 이미지 내에 추가하는 명령어
### COPY
 - 이미지 생성 시 특정 파일을 이미지 외부에서 내부로 복사하는 명령어
### WORKDIR
 - 명령어를 실행할 디렉토리.
 - BASH 쉘에서의 cd 명령어와 동일한 기능을 함
### EXPOSE
 - 호스트에 연결될 포트를 지정한다.
### CMD
 - 컨테이너가 시작될 때 스크립트 혹은 명령을 실행한다.
 - 만일 docker run으로 실행될 때 사용자가 직접 실행할 명령어를 입력하면 CMD의 명령어는 실행되지 않는다.

### ENTRYPOINT
 - 해당 컨테이너가 수행될 때 반드시 ENTRYPOINT에 속한 명령을 수행하도록 지정된다
 - 컨테이너가 시작되었을 때 스크립트 혹은 명령을 실행
 - Dockerfile에서 한 번만 정의 가능

### RUN, ENTRYPOINT, CMD의 차이
 - RUN 명령어는 도커파일로부터 도커 이미지를 빌드하는 순간에 실행되는 명령어이다. 그래서 RUN명령어는 주로 라이브러리를 설치하는 부분에 사용한다.
 - CMD, ENTRYPOINT 명령어는 이미지로부터 컨테이너를 생성항여 최초로 실행할 때 수행된다.
 - 둘의 차이는 컨테이너 시작시 실행 명령에 따른 default 지정 여부이다.
   - ENTRYPOINT를 사용해 컨테이너의 수행 명령을 정의한 경우 해당 컨테이너가 수행될 때 반드시 ENTRYPOINT에서 지정한 명령을 수행되도록 지정한다.
   - CMD를 사용한 수행 명령의 경우 docker run으로 컨테이너를 실행할 때 인자값을 주게 되면 dockerfile에 지정된 CMD값을 대신해 지정한 인자값으로 변경하여 실행되게 된다.